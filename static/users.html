<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة المستخدمين - نظام المحاسبة للإنتاج الفني</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-100">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar for desktop -->
        <div class="sidebar w-64 text-white hidden md:block">
            <div class="p-4">
                <div class="flex items-center justify-center mb-8">
                    <div class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-film text-white"></i>
                    </div>
                </div>
                <div class="mb-10 text-center">
                    <div class="h-16 w-16 mx-auto rounded-full border-2 border-white mb-2 bg-gray-600 flex items-center justify-center">
                        <i class="fas fa-user text-white text-xl"></i>
                    </div>
                    <h4 class="font-bold" id="currentUserName">المستخدم</h4>
                    <p class="text-xs text-gray-300" id="currentUserRole">الدور</p>
                </div>
                <nav>
                    <div class="mb-4">
                        <h5 class="text-sm uppercase text-gray-400 mb-2 px-4">القائمة الرئيسية</h5>
                        <a href="/dashboard.html" class="block py-2 px-4 rounded-lg hover:bg-gray-800 text-gray-300 mb-1">
                            <i class="fas fa-chart-line mr-2"></i> لوحة التحكم
                        </a>
                        <a href="/projects.html" class="block py-2 px-4 rounded-lg hover:bg-gray-800 text-gray-300 mb-1">
                            <i class="fas fa-film mr-2"></i> المشاريع
                        </a>
                        <a href="/payroll.html" class="block py-2 px-4 rounded-lg hover:bg-gray-800 text-gray-300 mb-1">
                            <i class="fas fa-money-bill-wave mr-2"></i> الرواتب والمصروفات
                        </a>
                        <a href="/transactions.html" class="block py-2 px-4 rounded-lg hover:bg-gray-800 text-gray-300 mb-1">
                            <i class="fas fa-dollar-sign mr-2"></i> المعاملات
                        </a>
                        <a href="/reports.html" class="block py-2 px-4 rounded-lg hover:bg-gray-800 text-gray-300 mb-1">
                            <i class="fas fa-chart-pie mr-2"></i> التقارير
                        </a>
                    </div>
                    <div class="mb-4" id="adminSection" style="display: none;">
                        <h5 class="text-sm uppercase text-gray-400 mb-2 px-4">الإدارة</h5>
                        <a href="/users.html" class="block py-2 px-4 rounded-lg bg-gray-800 text-white mb-1">
                            <i class="fas fa-users mr-2"></i> المستخدمين
                        </a>
                        <a href="/settings.html" class="block py-2 px-4 rounded-lg hover:bg-gray-800 text-gray-300 mb-1">
                            <i class="fas fa-cog mr-2"></i> الإعدادات
                        </a>
                    </div>
                </nav>
            </div>
        </div>

        <!-- Mobile menu overlay -->
        <div id="mobileMenu" class="fixed inset-0 z-50 md:hidden hidden">
            <div class="fixed inset-0 bg-black bg-opacity-50" id="mobileMenuOverlay"></div>
            <div class="fixed right-0 top-0 h-full w-64 bg-gray-800 text-white transform transition-transform duration-300 ease-in-out">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-8">
                        <div class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center">
                            <i class="fas fa-film text-white"></i>
                        </div>
                        <button id="closeMobileMenu" class="text-white hover:text-gray-300">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div class="mb-10 text-center">
                        <div class="h-16 w-16 mx-auto rounded-full border-2 border-white mb-2 bg-gray-600 flex items-center justify-center">
                            <i class="fas fa-user text-white text-xl"></i>
                        </div>
                        <h4 class="font-bold" id="mobileCurrentUserName">المستخدم</h4>
                        <p class="text-xs text-gray-300" id="mobileCurrentUserRole">الدور</p>
                    </div>
                    <nav>
                        <div class="mb-4">
                            <h5 class="text-sm uppercase text-gray-400 mb-2 px-4">القائمة الرئيسية</h5>
                            <a href="/dashboard.html" class="block py-2 px-4 rounded-lg hover:bg-gray-700 text-gray-300 mb-1">
                                <i class="fas fa-chart-line mr-2"></i> لوحة التحكم
                            </a>
                            <a href="/projects.html" class="block py-2 px-4 rounded-lg hover:bg-gray-700 text-gray-300 mb-1">
                                <i class="fas fa-film mr-2"></i> المشاريع
                            </a>
                            <a href="/payroll.html" class="block py-2 px-4 rounded-lg hover:bg-gray-700 text-gray-300 mb-1">
                                <i class="fas fa-money-bill-wave mr-2"></i> الرواتب والمصروفات
                            </a>
                            <a href="/transactions.html" class="block py-2 px-4 rounded-lg hover:bg-gray-700 text-gray-300 mb-1">
                                <i class="fas fa-dollar-sign mr-2"></i> المعاملات
                            </a>
                            <a href="/reports.html" class="block py-2 px-4 rounded-lg hover:bg-gray-700 text-gray-300 mb-1">
                                <i class="fas fa-chart-pie mr-2"></i> التقارير
                            </a>
                        </div>
                        <div class="mb-4" id="mobileAdminSection" style="display: none;">
                            <h5 class="text-sm uppercase text-gray-400 mb-2 px-4">الإدارة</h5>
                            <a href="/users.html" class="block py-2 px-4 rounded-lg bg-gray-700 text-white mb-1">
                                <i class="fas fa-users mr-2"></i> المستخدمين
                            </a>
                            <a href="/settings.html" class="block py-2 px-4 rounded-lg hover:bg-gray-700 text-gray-300 mb-1">
                                <i class="fas fa-cog mr-2"></i> الإعدادات
                            </a>
                        </div>
                    </nav>
                </div>
            </div>
        </div>

        <!-- Main content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Top header -->
            <header class="bg-white shadow-sm border-b border-gray-200 px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <button id="mobileMenuButton" class="md:hidden mr-4 text-gray-600 hover:text-gray-900">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        <h1 class="text-2xl font-bold text-gray-900">إدارة المستخدمين</h1>
                    </div>
                    <div class="flex items-center space-x-4 space-x-reverse">
                        <div class="relative">
                            <input type="text" placeholder="بحث..." class="bg-gray-100 border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-red-500" id="searchInput">
                            <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                        </div>
                        <div class="relative">
                            <button class="text-gray-600 hover:text-gray-900 relative">
                                <i class="fas fa-bell text-xl"></i>
                                <span class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">3</span>
                            </button>
                        </div>
                        <div class="relative">
                            <button id="userMenuButton" class="flex items-center space-x-2 space-x-reverse text-gray-700 hover:text-gray-900">
                                <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user text-sm"></i>
                                </div>
                                <span id="headerUserName">admin</span>
                                <i class="fas fa-chevron-down text-sm"></i>
                            </button>
                            <div id="userDropdown" class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 hidden">
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">الملف الشخصي</a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">الإعدادات</a>
                                <hr class="my-1">
                                <a href="#" onclick="logout()" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">تسجيل الخروج</a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Page content -->
            <main class="flex-1 overflow-y-auto p-6">
                <div class="max-w-7xl mx-auto">
                    <!-- Summary cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="dashboard-card p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">إجمالي المستخدمين</p>
                                    <p class="text-2xl font-bold text-blue-600" id="totalUsers">0</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-users text-blue-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">المديرين</p>
                                    <p class="text-2xl font-bold text-purple-600" id="adminUsers">0</p>
                                </div>
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-user-tie text-purple-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">المستخدمين العاديين</p>
                                    <p class="text-2xl font-bold text-green-600" id="regularUsers">0</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-user text-green-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">المستخدمين النشطين</p>
                                    <p class="text-2xl font-bold text-yellow-600" id="activeUsers">0</p>
                                </div>
                                <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-user-check text-yellow-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add user form -->
                    <div class="dashboard-card p-6 mb-8">
                        <h2 class="text-xl font-bold text-gray-900 mb-6">إضافة مستخدم جديد</h2>
                        <form id="userForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">اسم المستخدم</label>
                                <input type="text" id="username" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="اسم المستخدم">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">الاسم الكامل</label>
                                <input type="text" id="fullname" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="الاسم الكامل">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">البريد الإلكتروني</label>
                                <input type="email" id="email" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="example@domain.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">رقم الهاتف</label>
                                <input type="text" id="phone" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="01xxxxxxxxx">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">الدور</label>
                                <select id="role" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                    <option value="">اختر الدور</option>
                                    <option value="admin">مدير مالي</option>
                                    <option value="accountant">محاسب</option>
                                    <option value="auditor">مراقب</option>
                                    <option value="user">مستخدم عادي</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">كلمة المرور</label>
                                <input type="password" id="password" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="كلمة المرور">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">القسم</label>
                                <select id="department" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                    <option value="">اختر القسم</option>
                                    <option value="finance">المالية</option>
                                    <option value="production">الإنتاج</option>
                                    <option value="creative">الإبداع</option>
                                    <option value="technical">التقني</option>
                                    <option value="marketing">التسويق</option>
                                    <option value="hr">الموارد البشرية</option>
                                </select>
                            </div>
                            <div class="flex items-center mt-6">
                                <input type="checkbox" id="isActive" class="h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded">
                                <label for="isActive" class="ml-2 block text-sm text-gray-900">حساب نشط</label>
                            </div>
                            <div class="md:col-span-2 lg:col-span-3 flex gap-4">
                                <button type="submit" class="btn-cinematic px-6 py-2">
                                    <i class="fas fa-user-plus mr-2"></i>
                                    إضافة المستخدم
                                </button>
                                <button type="button" onclick="clearUserForm()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">
                                    <i class="fas fa-times mr-2"></i>
                                    إلغاء
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Users list -->
                    <div class="dashboard-card p-6 mb-8">
                        <h2 class="text-xl font-bold text-gray-900 mb-6">قائمة المستخدمين</h2>
                        <div class="overflow-x-auto">
                            <table class="w-full table-auto">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="px-4 py-3 text-right text-sm font-medium text-gray-700">اسم المستخدم</th>
                                        <th class="px-4 py-3 text-right text-sm font-medium text-gray-700">الاسم الكامل</th>
                                        <th class="px-4 py-3 text-right text-sm font-medium text-gray-700">البريد الإلكتروني</th>
                                        <th class="px-4 py-3 text-right text-sm font-medium text-gray-700">الدور</th>
                                        <th class="px-4 py-3 text-right text-sm font-medium text-gray-700">القسم</th>
                                        <th class="px-4 py-3 text-right text-sm font-medium text-gray-700">الحالة</th>
                                        <th class="px-4 py-3 text-right text-sm font-medium text-gray-700">الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <tr>
                                        <td colspan="7" class="px-4 py-8 text-center text-gray-500">
                                            <i class="fas fa-users text-4xl mb-4 text-gray-300"></i>
                                            <p>لا توجد مستخدمين حتى الآن</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Role Permissions -->
                    <div class="dashboard-card p-6">
                        <h2 class="text-xl font-bold text-gray-900 mb-6">صلاحيات الأدوار</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h3 class="text-lg font-bold text-gray-900 mb-2">مدير مالي</h3>
                                <ul class="list-disc list-inside text-gray-700">
                                    <li>✅ إدارة جميع المشاريع</li>
                                    <li>✅ إدارة المعاملات المالية</li>
                                    <li>✅ عرض جميع التقارير</li>
                                    <li>✅ إدارة المستخدمين</li>
                                    <li>✅ إعدادات النظام</li>
                                    <li>✅ إدارة الرواتب والمصروفات</li>
                                </ul>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h3 class="text-lg font-bold text-gray-900 mb-2">محاسب</h3>
                                <ul class="list-disc list-inside text-gray-700">
                                    <li>✅ إدارة المشاريع المخصصة</li>
                                    <li>✅ إدارة المعاملات المالية</li>
                                    <li>✅ عرض التقارير المالية</li>
                                    <li>❌ إدارة المستخدمين</li>
                                    <li>❌ إعدادات النظام</li>
                                    <li>✅ إدارة الرواتب</li>
                                </ul>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h3 class="text-lg font-bold text-gray-900 mb-2">مراقب</h3>
                                <ul class="list-disc list-inside text-gray-700">
                                    <li>👁️ عرض المشاريع</li>
                                    <li>👁️ عرض المعاملات</li>
                                    <li>👁️ عرض التقارير</li>
                                    <li>❌ إدارة المستخدمين</li>
                                    <li>❌ إعدادات النظام</li>
                                    <li>👁️ عرض الرواتب</li>
                                </ul>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h3 class="text-lg font-bold text-gray-900 mb-2">مستخدم عادي</h3>
                                <ul class="list-disc list-inside text-gray-700">
                                    <li>👁️ عرض المشاريع المخصصة</li>
                                    <li>❌ إدارة المعاملات</li>
                                    <li>👁️ عرض التقارير الأساسية</li>
                                    <li>❌ إدارة المستخدمين</li>
                                    <li>❌ إعدادات النظام</li>
                                    <li>❌ إدارة الرواتب</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div id="editUserModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-md">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">تعديل المستخدم</h2>
            <form id="editUserForm" class="grid grid-cols-1 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">اسم المستخدم</label>
                    <input type="text" id="editUsername" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">الاسم الكامل</label>
                    <input type="text" id="editFullname" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">البريد الإلكتروني</label>
                    <input type="email" id="editEmail" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">رقم الهاتف</label>
                    <input type="text" id="editPhone" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">الدور</label>
                    <select id="editRole" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                        <option value="admin">مدير مالي</option>
                        <option value="accountant">محاسب</option>
                        <option value="auditor">مراقب</option>
                        <option value="user">مستخدم عادي</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">القسم</label>
                    <select id="editDepartment" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                        <option value="finance">المالية</option>
                        <option value="production">الإنتاج</option>
                        <option value="creative">الإبداع</option>
                        <option value="technical">التقني</option>
                        <option value="marketing">التسويق</option>
                        <option value="hr">الموارد البشرية</option>
                    </select>
                </div>
                <div class="flex items-center mt-6">
                    <input type="checkbox" id="editIsActive" class="h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded">
                    <label for="editIsActive" class="ml-2 block text-sm text-gray-900">حساب نشط</label>
                </div>
                <div class="flex justify-end gap-4 mt-6">
                    <button type="submit" class="btn-cinematic px-6 py-2">
                        حفظ التغييرات
                    </button>
                    <button type="button" onclick="closeEditModal()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">
                        إلغاء
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="main.js"></script>
    <script src="users.js"></script>
</body>
</html>

